Полноценный PRD — MVP мобильной «русскоязычной клавиатуры + AI-перефразировщик»

Ниже — профессиональный документ требований для команды разработки на основе твоих ответов и присланных референсов. Я включил: цели, метрики, полноту фич, детальную UI/UX-спецификацию (с учётом референсов), техническую архитектуру (on-device + облако), API-контракты, требования по безопасности/приватности, монетизацию, acceptance-критерии, набор задач для разработки и список рисков с митигациями.

В документе я ссылаюсь на внешние сервисы/поставщиков — они помечены сущностями для однозначности.
Supabase OpenRouter Render Railway Fly.io LanguageTool Apple Google

1. Краткое резюме продукта и цели

MVP — мобильная клавиатура (iOS + Android) и сопутствующее приложение (React Native), ориентированная на русскоязычных пользователей (Россия). Ключевые возможности:

Локальная быстрая проверка: орфография, морфология/согласование, базовая пунктуация (работает оффлайн).

AI-перефраз (онлайн): полностью переписывает всё введённое сообщение по выбранному режиму (один вариант по умолчанию).

UX «клавиатура + всплывающий контейнер» 1:1 по референсу (тёмная тема по умолчанию, кнопки режимов: Shorten/Sokratit, Friendly/Druzhelyubnyi, Formal/Formal и пр.).

Монетизация: freemium; подписка 199 ₽/мес (PRO) + лимиты бесплатных перефразов.

География: запуск — Россия; язык интерфейса и проверки — только русский.

Основная бизнес-цель MVP: быстро набрать активных пользователей (студенты, контент-мейкеры) и добиться 3% конверсии в подписку.

2. Целевые метрики успеха (KPI)

DAU / MAU (целевой рост — измеряем)

Активация клавиатуры (пользователь включил и использует) — % от установок

Среднее количество перефразов на активного пользователя (retention signal)

Конверсия в подписку: целевая 3%

Среднее время ответа сервиса (latency) — контрольная метрика для UX

Количество жалоб по приватности / CSAT

3. Перечень функций MVP (минимально необходимое)

Функции, обязательные в MVP (с учётом ответов):

Нативная клавиатура iOS/Android

Кнопки: «Проверить/Исправить», «Перефразировать», режимы (Shorten/Сократить, Friendly/Дружелюбный, Formal/Формальный, Expand/Расширить, Уверенный, Профессиональный, Разговорный, Эмпатичный).

Интеграция с основной RN-аппой (settings, billing, notes).

Локальная проверка текста (on-device)

Орфография (словарь + Levenshtein подход), быстрая подсветка.

Морфологический анализ (согласование) — подсказки и подсветка.

Базовая пунктуация (rule-engine).

Поведение: неправильные/удалённые символы выделяются красным; добавленные/предложенные — зелёным (как в референсе).

AI-перефраз (облачный)

На явный запрос (кнопка «Перефразировать») весь текущий текст поля отправляется на сервер → LLM → 1 вариант по умолчанию возвращается и отображается в том же контейнере (popup) — user подтверждает вставку.

При встрече английских слов — они остаются без изменения.

Основное приложение (React Native)

Onboarding (обязательное): как включить клавиатуру, объяснение «Allow Full Access», privacy.

Notes (простой редактор) — для демонстрации клавиатуры и тестов.

Настройки: тема (авто/тёмная/светлая), подписка, лимиты.

Billing

In-app purchase / подписка 199 ₽/мес.

Freemium: ограниченное число бесплатных перефразов (напр., X в месяц).

Analytics: установки, активации, запросы перефраза, среднее время ответа, события платежа, ошибки.

4. UI / UX спецификация (точно по референсу)

(Используй присланные изображения как точный визуал-референс. Ниже — технически детализированное описание видимых элементов.)

Главное UI-поведение клавиатуры

Тема: по умолчанию тёмная; реактивно подстраивается под системный режим (iOS/Android). Настройки в RN-приложении дают выбор.

Всплывающий модуль над клавиатурой (floating panel), занимающий ~40–55% высоты экрана над клавиатурой (как на референсе). Модуль содержит:

Заголовок: «Add warmth and friendliness» / локализованный текст.

Большое текстовое поле (preview) с подсветкой: слова с ошибками — красные подчёркнутые блоки, вставленные/изменённые слова — зелёные; формат подсветки — как на скриншоте (заливка highlight, не только подчёркивание).

Ряд кнопок выбора режима (горизонтальный scroller) — иконки + подписи: Shorten (иконка ножниц), Friendly (лицо), Formal (рубашка) и далее режимы. Активный режим подсвечен бордюром/фоновой подсветкой.

Набор quick-actions внизу: клавиатура (иконка), rotate/undo, magic (перефразировать), copy (буфер), подтвердить (check в круге).

Поведение вставки: пользователь нажимает «галочку» — заменяем текущее поле ввода содержимым результата; при этом контейнер закрывается и результат вставляется.

Подсветки изменений

Ошибка (исходный текст): выделять зелёным? Нет — ты просил: «места с неправильными словами или знаками препинания выделялись красным, а новые добавленные слова или знаки препинания зеленым». Значит:

Исходные некорректные фрагменты: красная заливка.

Предложенные вставки/замены (в итоговом варианте) — зелёная заливка (в preview).

Когда показывается только корректировка (без перефраза), показывать diff-view с красными и зелёными сегментами, точно как на референсе.

Цвета: используем контрастный тёмный фон; красный (#E35A5A) и зелёный (#39C07C) для заливки; текст белый/светло-серый.

Onboarding (обязательный flow)

Экран 1: приветствие + ключевая ценность (корректность + перефраз) — кнопка «Add Keyboard» (как на референсе).

Экран 2: как включить клавиатуру в настройках iOS (скриншот референса) + объяснение «Why Full Access?» (короткий текст).

Скрин: опция «только локальная проверка» и «включить облачные функции» (вкл/выкл).

Текст в onboarding должен прямо объяснять: «Мы не храним тексты. Облачные перефраз-запросы отправляются только при нажатии «Перефразировать»».

Notes (внутри RN-приложения)

Простая страница с редактором, где по умолчанию используется наша клавиатура и можно протестировать все опции.

Кнопка «History/Limit» — показывает оставшиеся бесплатные перефразов в текущем периоде.

5. Техническая архитектура (высокоуровнево)

Архитектура = клиент (React Native app + native keyboard extensions) + backend (Node.js/Fastify + Supabase) + LLM proxy (OpenRouter).

Почему разделение RN + native keyboard

RN — удобен для основного приложения, экрана настроек, billing, notes.

Keyboard extension на iOS/Android реализуется нативно (Swift/Kotlin) из-за ограничений extension (память, lifecycle). RN внутри extension даёт нестабильность.

On-device (локальная) стек

Библиотеки:

Морфология: на устройстве использовать компилированные словари / ported rules. Для mobile on-device можно использовать precompiled lookup tables (Trie) + продвинутый словарь, либо интеграцию с tiny Rust/Go библиотекой, скомпилированной в нативный код.

Spellcheck: Hunspell-style dicts (русский словарь) или compact trie.

Rule engine: набор правил на Kotlin/Swift (регулярные выражения + контекстные шаблоны).

Поведение:

Локально — выполняется супер-быстрая проверка при вводе и при нажатии «Проверить». Никакие данные не уйдут в облако без явного подтверждения.

Бэкенд (обработка перефраза)

Хостинг: вендор-нейтральные платформы (Render / Railway / Fly.io) — автодеплой из GitHub, управляемые контейнеры, встроенное логирование.

Технологический стек:

Runtime: Node.js 22.x LTS + TypeScript 5.9.x

Фреймворк: Fastify 5.x (высокая производительность, типобезопасность)

База данных и аутентификация: Supabase (managed PostgreSQL + Supabase Auth + RLS)

Сервисный стек:

API gateway — Fastify routes с Zod-валидацией

Auth — Supabase Auth (email/phone + OAuth providers)

Paraphrase service — серверный прокси → OpenRouter (LLM агрегатор)

PII Masking Layer — обязательная обработка перед отправкой в LLM

Circuit Breaker — Opossum для защиты от каскадных сбоев

Caching layer (Redis / Upstash) — кэшировать недавние запросы (опционально для MVP)

Observability: Pino логирование, health endpoints

LLM вызовы:

Все вызовы через OpenRouter REST API — сервер-сайд only (API ключи НЕ на клиенте).

Модели: DeepSeek-V3 (основная), GPT-4o-mini (fallback).

Перед отправкой — ОБЯЗАТЕЛЬНАЯ фильтрация/маскирование персональных данных (телефоны, e-mail, номера карт, паспортные данные).

6. API контракт (ключевой endpoint) — пример

Ниже — минимальный контракт для перефразировки (HTTP REST).

POST /v1/paraphrase
Headers:

Authorization: Bearer <JWT>

Content-Type: application/json

Body:

{
  "user_id": "string",
  "session_id": "string",
  "text": "Исходный текст пользователя",
  "mode": "shorten|expand|formal|friendly|confident|professional|colloquial|empathetic",
  "preserve_english": true,
  "max_length": null, // optional: numeric limit
  "request_idempotency_key": "optional"
}


Response:

{
  "request_id": "string",
  "input_text": "Исходный текст пользователя",
  "output_text": "Перефразированный текст",
  "diff": [
    {"type": "delete", "start": 10, "end": 20, "text": "..."},
    {"type": "insert", "pos": 10, "text": "новый текст"}
  ],
  "warnings": [],
  "processing_time_ms": 420
}


Дополнительно:

Endpoint /v1/check для глубокой серверной проверки (LanguageTool/Orfogrammka style) — возвращает список ошибок и позиции.

7. Prompt-шаблоны для LLM (готовые к внедрению)

(Отправлять в LLM-provider; параметры temperature низкие для детерминированности.)

System:

Ты — ассистент по перефразированию текста на русском языке. Сохраняй смысл, не добавляй фактов. Оставляй английские слова без изменений. Не используй эмодзи. Запрещены оскорбления. Максимальная длина результата — <max_length> (если указан). Формат ответа: только итоговый текст.


User (пример для режима «дружелюбный»):

MODE: дружелюбный
INPUT: <user_text>
INSTRUCTIONS: Сделай текст тёплым и дружелюбным, сохрани смысл, избегай формальностей, не используй эмодзи.


Для «формального» добавить: «Не используй сокращения; избегай разговорных оборотов».

8. Приватность и безопасность (политика обработки текстов)

Ключевые требования, по твоим ответам:

Тексты отправляются в облако только при явном действии «Перефразировать» (или других кнопках, требующих облачной обработки). (п.50)

По возможности — не хранить тексты на сервере. Обрабатывать в памяти, возвращать результат и удалять. Логи должны быть анонимизированы. (п.51)

Возможность полного удаления данных пользователя по запросу. (п.52)

TLS/HTTPS для транспорта обязателен; шифрование на покое для чувствительных данных — да. (п.53)

Маскирование PII перед отправкой в LLM (телефоны, эмейлы, номера карт). (п.54)

Подписи/тексты для App Store и onboarding объясняют «Allow Full Access» и какие данные уходят. (п.55)

Технические меры

TLS 1.2+ обязательный.

Шифрование at rest: AES-256 (для любых временных хранилищ).

Не логировать исходный текст; логировать хэши/анонимизированные метрики.

JWT для аутентификации мобильного клиента; refresh token flow.

Режим «только локально» — явно доступен в настройках (блокирует облачные операции).

9. Вендор-нейтральный хостинг — архитектурный выбор

Выбрана вендор-нейтральная архитектура по следующим причинам:

Гибкость развёртывания: возможность переноса между провайдерами (Render, Railway, Fly.io) без изменения кода.

Быстрый старт MVP: все платформы поддерживают автодеплой из GitHub, управляемые контейнеры, встроенное логирование.

Supabase как managed backend: PostgreSQL + Auth + RLS из коробки, бесплатный tier для MVP, масштабирование по мере роста.

OpenRouter как LLM proxy: единый API для доступа к множеству моделей (DeepSeek, GPT-4o, Claude), fallback между провайдерами.

Стоимость: конкурентные цены для стартапа; pay-as-you-go модель.

Безопасность: server-side proxy архитектура — API ключи LLM провайдеров только на сервере, никогда на клиенте.

Платформы для MVP:

Backend: Render / Railway / Fly.io (Node.js/Fastify контейнер)

Database + Auth: Supabase (managed PostgreSQL + RLS)

LLM Gateway: OpenRouter (REST API)

Cache (опционально): Upstash Redis

(Итого: архитектура не привязана к конкретному облачному провайдеру и позволяет быстро масштабироваться или мигрировать при необходимости.)

10. Монетизация и лимиты

Подписка: 199 ₽/мес (PRO). Freemium: лимит бесплатных перефразов (предложение: например, 5 бесплатных перефразов в месяц — это нужно окончательно определить).

Ограничение символов в бесплатном режиме — реализуется на бэке; валидируется на клиенте и показывается предупреждение в UI.

Механика: при исчерпании бесплатных лимитов — CTA «Оформить PRO».

11. Analytics, логирование и события

Список ключевых событий для отслеживания (аналитика):

install_app

enable_keyboard

session_start

check_local (spellcheck count)

paraphrase_request (mode, length, latency)

paraphrase_result (success/fail, processing_time_ms)

insert_result (user вставил ответ)

subscription_purchase / subscription_cancel

error_* (код ошибки)

Инструменты: можно начать с простого stack (self-hosted metrics / ELK) либо third-party analytics; не трекать содержимое текстов (privacy).

12. Acceptance criteria / QA тесты (важно)

Каждая фича должна иметь чек-лист:

Local spellcheck

При вводе слова с ошибкой — подсветка красным сразу (в 95% типичных случаев).

Предложение исправления появляется при нажатии «Проверить».

Предложения не ломают вставляемый текст (правила согласования соблюдены).

Diff view (red/green)

При проверке/перефразе preview показывает исходные удалённые сегменты красным и предложенные вставки зелёным.

При нажатии «галочка» финальный текст вставляется в поле ввода.

Peraphrase endpoint

Отправка полного поля на /paraphrase возвращает output_text и diff.

Английские слова в output совпадают с англ. словами из input.

Onboarding

Пошаговая инструкция по включению клавиатуры доступна и корректна на iOS и Android.

Privacy

При выборе «только локально» облачные запросы не отправляются.

По запросу пользователя данные удаляются.

Subscription

Процесс покупки работает; лимиты корректно применяются.

13. Набор задач (JIRA-style) — минимальный набор для разработки MVP

(Группируй в эпики: Core Keyboard, Backend & AI, RN App, Security & Infra, QA)

Epic: Core Keyboard (iOS + Android, native)

TASK: Implement base keyboard layout (RU) with standard keys.

TASK: Implement floating popup container UI (matching ref).

TASK: Implement local spellcheck integration using compact dictionary + Levenshtein.

TASK: Implement morphological checks (rule engine) on device.

TASK: Implement diff/highlight rendering (red/green).

TASK: Implement action buttons (Проверить, Перефразировать, режимы).

TASK: Implement English-token preservation logic.

Epic: Backend & AI

TASK: Implement /v1/paraphrase and /v1/check endpoints.

TASK: Integrate LLM provider (internal or external) + prompt templates.

TASK: Implement masking of PII before sending to LLM.

TASK: Implement Redis cache + processing queue.

TASK: Implement billing integration + user subscription management.

Epic: RN App (Settings / Onboarding / Notes)

TASK: Onboarding flow (two screens: enable keyboard, Allow Full Access explanation).

TASK: Settings (theme, mode local/online, subscription).

TASK: Notes page with editor using system keyboard by default set to our keyboard.

Epic: Security & Infra

TASK: Deploy on Render / Railway / Fly.io — Fastify API, Supabase (PostgreSQL + Auth).

TASK: Configure OpenRouter for LLM proxy (server-side only).

TASK: TLS, encryption at rest setup.

TASK: Implement data retention policy (no persistence of raw texts).

TASK: Implement delete-user data API.

Epic: QA & Acceptance

TASK: Create test cases for all acceptance criteria.

TASK: Manual UX testing on iPhone real devices (keyboard extension).

TASK: Stress testing backend under expected load (max 20k marketing budget — set assumptions).

14. Риски + митигации

iOS keyboard extension limits (memory, no RN)

Митиг.: нативная реализация extension; тяжелые операции перенаправлять в основное приложение или облако.

Приватность: пользователи не дадут Allow Full Access

Митиг.: сделать понятный onboarding, режим «только локально» для базовой работы.

LLM-стоимость (перефраз)

Митиг.: кэширование, лимиты, freemium, batching запросов.

Качество перефраза (русский)

Митиг.: тщательная настройка prompt-ов; ручная проверка примеров; тестовый набор для режимов; A/B-тестирование.

Конкуренция со встроенными клавиатурами (Яндекс/крупные игроки)

Митиг.: фокус на локализации, UX, дифф-view и быстрый go-to-market.

15. Документы/тексты для onboarding и App Store (черновик)

Onboarding headline (RU):

Быстрее писать, чище выражать мысли. Наша клавиатура проверяет орфографию и перефразирует сообщения — только при вашем запросе. Чтобы использовать облачные функции, включите «Разрешить полный доступ». Мы не храним ваши тексты.

Короткий текст для App Store (RU):

Умная клавиатура для русского: мгновенная проверка орфографии и морфологии + AI-перефраз в одном месте. Freemium: попробуй бесплатно, PRO — 199 ₽/мес.

(Это нужно локализовать и утвердить юристом.)

16. Примеры acceptance-tests (конкретные кейсы)

Ввод: Превет, как дела → при нажатии «Проверить» слово Превет подсвечивается красным; предлагаем Привет. После выбора — вставляется Привет, как дела.

Перефраз: ввод: Я считаю что это плохая идея → выбрать режим «Дружелюбный» → получаем output: Мне кажется, это не самая лучшая идея. — английских слов нет, так что правило про английские слова не проверяется.

Сохранение английских слов: ввод: This is test, всё ок → перефраз: фрагмент This is test остаётся unchanged.