/**
 * RussianDictionary - Basic Russian dictionary for spell checking
 * Contains common words and methods for similarity search
 */

package ai.reword.keyboard.spellcheck

object RussianDictionary {
    
    // Common Russian words (top ~5000 would be loaded from file in production)
    // This is a small subset for demonstration
    private val commonWords = setOf(
        // Pronouns
        "я", "ты", "он", "она", "оно", "мы", "вы", "они",
        "мне", "тебе", "ему", "ей", "нам", "вам", "им",
        "меня", "тебя", "его", "её", "нас", "вас", "их",
        "мой", "твой", "его", "её", "наш", "ваш", "их",
        "себя", "себе", "собой",
        "кто", "что", "какой", "который", "чей", "сколько",
        "этот", "тот", "такой", "столько",
        "весь", "всё", "все", "каждый", "любой", "другой", "иной", "сам",
        
        // Verbs (common)
        "быть", "есть", "был", "была", "было", "были", "будет", "будут",
        "иметь", "имею", "имеет", "имеют",
        "мочь", "могу", "может", "можем", "можете", "могут",
        "хотеть", "хочу", "хочет", "хотим", "хотите", "хотят",
        "знать", "знаю", "знает", "знаем", "знаете", "знают",
        "говорить", "говорю", "говорит", "говорим", "говорите", "говорят",
        "сказать", "скажу", "скажет", "скажем", "скажете", "скажут",
        "делать", "делаю", "делает", "делаем", "делаете", "делают",
        "сделать", "сделаю", "сделает", "сделаем", "сделаете", "сделают",
        "видеть", "вижу", "видит", "видим", "видите", "видят",
        "смотреть", "смотрю", "смотрит", "смотрим", "смотрите", "смотрят",
        "идти", "иду", "идёт", "идём", "идёте", "идут",
        "пойти", "пойду", "пойдёт", "пойдём", "пойдёте", "пойдут",
        "работать", "работаю", "работает", "работаем", "работаете", "работают",
        "думать", "думаю", "думает", "думаем", "думаете", "думают",
        "понимать", "понимаю", "понимает", "понимаем", "понимаете", "понимают",
        "понять", "пойму", "поймёт", "поймём", "поймёте", "поймут",
        "писать", "пишу", "пишет", "пишем", "пишете", "пишут",
        "написать", "напишу", "напишет", "напишем", "напишете", "напишут",
        "читать", "читаю", "читает", "читаем", "читаете", "читают",
        "прочитать", "учить", "учу", "учит", "учим", "учите", "учат",
        "жить", "живу", "живёт", "живём", "живёте", "живут",
        "любить", "люблю", "любит", "любим", "любите", "любят",
        "дать", "дам", "даст", "дадим", "дадите", "дадут",
        "взять", "возьму", "возьмёт", "возьмём", "возьмёте", "возьмут",
        "стать", "стану", "станет", "станем", "станете", "станут",
        "получить", "получу", "получит", "получим", "получите", "получат",
        "оставить", "оставлю", "оставит", "оставим", "оставите", "оставят",
        "найти", "найду", "найдёт", "найдём", "найдёте", "найдут",
        "прийти", "приду", "придёт", "придём", "придёте", "придут",
        "выйти", "выйду", "выйдет", "выйдем", "выйдете", "выйдут",
        
        // Nouns (common)
        "человек", "люди", "время", "год", "день", "жизнь", "работа",
        "дело", "рука", "место", "лицо", "друг", "глаз", "вопрос",
        "дом", "страна", "мир", "случай", "голова", "ребёнок", "дети",
        "сторона", "слово", "женщина", "мужчина", "деньги", "город",
        "вода", "земля", "конец", "система", "часть", "власть",
        "история", "книга", "комната", "машина", "минута", "мысль",
        "народ", "начало", "ночь", "область", "образ", "отец",
        "письмо", "помощь", "правда", "президент", "проблема", "путь",
        "результат", "решение", "россия", "свет", "семья", "сила",
        "смерть", "собака", "состояние", "стол", "телефон", "условие",
        "утро", "форма", "цель", "час", "число", "школа",
        
        // Adjectives (common)
        "новый", "большой", "хороший", "первый", "последний", "высокий",
        "молодой", "старый", "главный", "русский", "общий", "важный",
        "маленький", "разный", "белый", "чёрный", "красный", "синий",
        "зелёный", "жёлтый", "длинный", "короткий", "широкий", "узкий",
        "тяжёлый", "лёгкий", "сильный", "слабый", "быстрый", "медленный",
        "простой", "сложный", "красивый", "плохой", "нужный", "полный",
        "правый", "левый", "верхний", "нижний", "передний", "задний",
        
        // Adverbs
        "очень", "уже", "ещё", "тоже", "также", "только", "даже",
        "сейчас", "теперь", "потом", "здесь", "там", "где", "когда",
        "как", "почему", "зачем", "куда", "откуда", "всегда", "никогда",
        "иногда", "часто", "редко", "быстро", "медленно", "хорошо",
        "плохо", "много", "мало", "больше", "меньше", "лучше", "хуже",
        "вместе", "отдельно", "вперёд", "назад", "вверх", "вниз",
        
        // Prepositions
        "в", "на", "с", "к", "у", "о", "об", "по", "за", "из",
        "от", "до", "для", "без", "под", "над", "перед", "между",
        "через", "при", "про", "после", "около", "вокруг",
        
        // Conjunctions
        "и", "а", "но", "или", "что", "как", "если", "когда",
        "чтобы", "потому", "поэтому", "хотя", "пока", "либо",
        
        // Particles
        "не", "ни", "бы", "ли", "же", "вот", "вон", "да", "нет",
        
        // Numbers
        "один", "два", "три", "четыре", "пять", "шесть", "семь",
        "восемь", "девять", "десять", "сто", "тысяча", "миллион",
        "первый", "второй", "третий", "четвёртый", "пятый"
    )
    
    // Trie for efficient prefix lookup
    private val trie = Trie()
    
    init {
        // Build trie from common words
        commonWords.forEach { trie.insert(it) }
    }
    
    /**
     * Check if word exists in dictionary
     */
    fun contains(word: String): Boolean {
        return commonWords.contains(word.lowercase()) || trie.search(word.lowercase())
    }
    
    /**
     * Get words starting with prefix
     */
    fun getWordsWithPrefix(prefix: String, limit: Int = 10): List<String> {
        return trie.getWordsWithPrefix(prefix.lowercase(), limit)
    }
    
    /**
     * Get similar words using Levenshtein distance
     */
    fun getSimilarWords(word: String, limit: Int = 5): List<String> {
        val lowerWord = word.lowercase()
        val maxDistance = when {
            word.length <= 3 -> 1
            word.length <= 6 -> 2
            else -> 3
        }
        
        return commonWords
            .filter { levenshteinDistance(it, lowerWord) <= maxDistance }
            .sortedBy { levenshteinDistance(it, lowerWord) }
            .take(limit)
    }
    
    /**
     * Get completions for partial word
     */
    fun getCompletions(partial: String, limit: Int = 5): List<String> {
        return getWordsWithPrefix(partial, limit)
    }
    
    private fun levenshteinDistance(s1: String, s2: String): Int {
        val m = s1.length
        val n = s2.length
        
        if (m == 0) return n
        if (n == 0) return m
        
        val matrix = Array(m + 1) { IntArray(n + 1) }
        
        for (i in 0..m) matrix[i][0] = i
        for (j in 0..n) matrix[0][j] = j
        
        for (i in 1..m) {
            for (j in 1..n) {
                val cost = if (s1[i - 1] == s2[j - 1]) 0 else 1
                matrix[i][j] = minOf(
                    matrix[i - 1][j] + 1,
                    matrix[i][j - 1] + 1,
                    matrix[i - 1][j - 1] + cost
                )
            }
        }
        
        return matrix[m][n]
    }
}
