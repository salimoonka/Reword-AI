/**
 * Prompt Templates for Paraphrasing
 * Optimized for speed and quality
 * 8 modes as specified in PRD
 */

export type ParaphraseMode =
  | 'paraphrase'
  | 'shorten'
  | 'expand'
  | 'formal'
  | 'friendly'
  | 'confident'
  | 'professional'
  | 'colloquial'
  | 'empathetic';

// Strict system prompt — output ONLY rewritten text, no meta-commentary
export const SYSTEM_PROMPT = `Ты перефразируешь текст на русском языке.

СТРОГИЕ ПРАВИЛА:
- Выводи ТОЛЬКО перефразированный текст — ничего больше.
- ЗАПРЕЩЕНО добавлять вступления ("Вот вариант:", "Вот более тёплый вариант:" и т.д.).
- ЗАПРЕЩЕНО добавлять комментарии, пояснения или послесловия ("Так звучит мягче", "Надеюсь, поможет" и т.д.).
- ЗАПРЕЩЕНО добавлять эмодзи от себя.
- Английские слова и имена собственные оставляй без изменений.
- Сохраняй исходный смысл и форматирование (абзацы, переносы строк).
- Твой ответ должен содержать ИСКЛЮЧИТЕЛЬНО переработанный текст пользователя.`;

// Detailed mode instructions — each prompt precisely describes tone, vocabulary,
// sentence structure, and transformation rules so the LLM produces consistent,
// high-quality results across all styles.
export const MODE_INSTRUCTIONS: Record<ParaphraseMode, string> = {
  paraphrase: `Перефразируй текст, используя другие слова и синтаксические конструкции.
Правила:
- Замени ключевые слова синонимами, перестрой предложения (активный↔пассивный залог, перестановка частей, замена придаточных причастными/деепричастными оборотами и наоборот).
- Сохрани исходный смысл, степень детализации, стиль и эмоциональный тон (если оригинал формальный — оставь формальным; если разговорный — оставь разговорным).
- Исправь орфографические, пунктуационные и грамматические ошибки.
- Не добавляй новую информацию и не убирай существующую.
- Длина результата должна быть примерно равна длине оригинала (±15%).
- Имена собственные, числа, даты, аббревиатуры и ссылки оставь без изменений.`,

  shorten: `Сократи текст, сохранив ключевую мысль и все важные факты.
Правила:
- Удали повторы, «воду», вводные слова, избыточные уточнения и канцеляризмы.
- Объедини короткие предложения в одно, если это не вредит читаемости.
- Целевая длина — 40–60% от оригинала. Если текст уже короткий (1–2 предложения), сократи только лексически, не теряя смысла.
- Не упускай фактов, цифр, имён и ключевых аргументов.
- Стиль и тон оригинала сохраняй (деловой оставь деловым, дружеский — дружеским).
- Если в тексте есть списки — сохрани формат списка, но убери лишние пункты, если они дублируют друг друга.`,

  expand: `Расширь текст, добавив подробности, примеры и пояснения.
Правила:
- Раскрой тезисы автора: добавь аргументы, иллюстрации, уточняющие детали.
- Используй связующие фразы для плавных переходов между мыслями (например, «кроме того», «важно отметить», «в частности»).
- Целевая длина — 150–200% от оригинала. Не раздувай текст пустыми повторами — каждое добавление должно нести ценность.
- Сохрани стиль и тон оригинала., не переключайся на другой регистр.
- Не меняй основной тезис и не добавляй противоречащую информацию.
- Новые детали должны логически следовать из контекста оригинала, а не быть выдуманными фактами.
- Если оригинал содержит список — можно добавить пояснение к каждому пункту.`,

  formal: `Переведи текст в официально-деловой регистр.
Правила:
- Замени разговорную лексику нейтральными или книжными эквивалентами («получить» → «приобрести/получить», «крутой» → «превосходный», «ок» → «хорошо/согласовано»).
- Используй полные грамматические конструкции: избегай сокращений, сленга, просторечий.
- Предложения должны быть структурированными, средней длины. Допускаются сложноподчинённые конструкции, характерные для делового стиля.
- Обращения — на «Вы» (с заглавной буквы, если контекст допускает).
- Сохрани все факты, даты, цифры и ключевые термины.
- Не превращай текст в канцелярит — он должен оставаться читаемым, а не бюрократическим.
- Эмодзи, если были в оригинале, — убери.
- Подходит для: деловой переписки, служебных записок, официальных обращений.`,

  friendly: `Сделай текст тёплым, дружелюбным и приятным в общении.
Правила:
- Используй мягкие формулировки с позитивным оттенком: «рад сообщить», «будет здорово, если», «с удовольствием».
- Добавь элементы живого общения: лёгкие вводные (например, «кстати», «между прочим»), дружественные обращения.
- Замени сухие констатации более эмоциональными конструкциями, но без фамильярности.
- Обращение — на «ты» или на «вы» (без заглавной), в зависимости от контекста оригинала. Если неясно — используй «ты».
- Можно добавить одну уместную эмодзи в конце, если это подходит контексту (не более одной).
- Сохрани весь смысл и ключевые факты оригинала.
- Тон — как у доброго друга, который объясняет что-то терпеливо и с улыбкой.
- Подходит для: переписки с друзьями, коллегами в неформальном чате, сообщений в мессенджерах.`,

  confident: `Сделай текст уверенным, решительным и утвердительным.
Правила:
- Убери все маркеры неуверенности: «может быть», «наверное», «мне кажется», «я думаю», «возможно», «не уверен».
- Замени условные конструкции утвердительными: «если получится» → «когда сделаем», «хотелось бы» → «мы сделаем/планируем».
- Используй активный залог и короткие, энергичные предложения.
- Тон — решительный, но не агрессивный. Текст должен звучать как речь лидера, который знает, что делает.
- Избегай извинений, оправданий и чрезмерной вежливости, если они ослабляют посыл.
- Сохрани содержание и факты оригинала — меняй только подачу.
- Подходит для: презентаций, деловых предложений, мотивирующих сообщений, резюме.`,

  professional: `Переведи текст в профессиональный деловой стиль.
Правила:
- Используй профессиональную лексику, характерную для бизнес-коммуникаций: «реализовать», «оптимизировать», «обеспечить», «в рамках», «с учётом».
- Структура предложений — чёткая, логичная, без лишних отступлений.
- Тон — спокойный, компетентный, уважительный. Без эмоций, но и не сухо-бюрократический.
- Обращения — на «вы». Если контекст подразумевает конкретного адресата, используй уважительное обращение.
- Термины и аббревиатуры из оригинала сохрани; жаргон замени общепринятыми профессиональными терминами.
- Длина текста остаётся примерно такой же (±20%).
- Отличие от «formal»: professional — это рабочий стиль между коллегами; formal — это официальные документы и письма внешним адресатам.
- Подходит для: рабочих писем, отчётов, комментариев к задачам, сообщений в рабочих чатах.`,

  colloquial: `Перепиши текст разговорным языком — так, как люди реально общаются в жизни.
Правила:
- Используй простые, короткие предложения. Допускаются разговорные обороты: «ну типа», «короче», «вообще», «кстати», «в общем».
- Замени книжные и формальные слова повседневными: «осуществить» → «сделать», «в связи с тем, что» → «потому что», «является» → «это».
- Тон — непринуждённый, живой, как будто человек рассказывает другу.
- Не перебарщивай с жаргоном или грубостью — текст должен звучать натурально и приятно.
- Обращение — на «ты».
- Можно слегка упростить сложные конструкции, но не теряй важные факты.
- Если оригинал содержит термины, оставь их, но добавь простое пояснение, если это уместно.
- Подходит для: сообщений в мессенджерах, постов в соцсетях, неформальных писем.`,

  empathetic: `Перепиши текст с выраженной эмпатией, заботой и пониманием.
Правила:
- Продемонстрируй, что чувства и ситуация собеседника важны: используй фразы вроде «я понимаю», «это действительно непросто», «ценю, что ты поделился».
- Смягчи категоричные или резкие формулировки: «ты не прав» → «я понимаю твою точку зрения, но, возможно, стоит учесть…».
- Используй тёплую, поддерживающую лексику. Избегай обвинений, сарказма и отстранённости.
- Тон — как у близкого человека, который внимательно слушает и искренне хочет помочь.
- Если в оригинале есть негативный посыл (критика, жалоба), переформулируй его конструктивно, сохраняя суть, но убирая агрессию.
- Сохрани все ключевые факты оригинала.
- Обращение — предпочтительно на «ты», если контекст позволяет.
- Подходит для: ответов на жалобы, поддержки коллеги в трудной ситуации, деликатных тем.`,
};

export function buildPrompt(text: string, mode: ParaphraseMode): string {
  return `${MODE_INSTRUCTIONS[mode]}
Выдай ТОЛЬКО результат без вступлений, пояснений и комментариев.

Текст: ${text}

Результат:`;
}

export default { SYSTEM_PROMPT, MODE_INSTRUCTIONS, buildPrompt };
